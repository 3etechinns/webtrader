<div class="indicator-builder">
    <table width="100%">
      <colgroup>
        <col style="width:30%">
        <col style="width:70%">
      </colgroup>
        <tr rv-if="formula">
          <td colspan="2" class="formula">
            <img rv-attr-src="formula">
          </td>
        </tr>
        <tr rv-if="formula | negate">
          <td colspan="2" class="description">
            {description}
          </td>
        </tr>
        <tr rv-each-row="fields">
          <td>{row.title}</td>
          <td rv-if="row.type | eq 'slider'">
            <div rv-slider="row.value" rv-attr-min="row.min" rv-attr-max="row.max"></div>
          </td>
          <td rv-if="row.type | eq 'colorpicker'">
            <div rv-colorpicker="row.value"></div>
            <div class="colorpicker-preview" rv-css-background="row.value"></div>
          </td>
          <td rv-if="row.type | eq 'dashstyle'">
            <div class="dash-styles">
                <div
                  rv-each-dash="dash_styles"
                  rv-class-dash-selected="row.value | eq dash.name"
                  rv-attr-value="dash.name"
                  rv-on-click="update_dash | bind dash | bind row"
                  rv-css-background-image="dash.url"></div>
            </div>
          </td>
          <td rv-if="row.type | eq 'appliedto'">
            <div class="applied-to">
                <div rv-class-selected="row.value | eq 0" rv-on-click="update_appliedto | bind row | bind 0">OPEN</div>
                <div rv-class-selected="row.value | eq 1" rv-on-click="update_appliedto | bind row | bind 1">HIGH</div>
                <div rv-class-selected="row.value | eq 2" rv-on-click="update_appliedto | bind row | bind 2">LOW</div>
                <div rv-class-selected="row.value | eq 3" rv-on-click="update_appliedto | bind row | bind 3">CLOSE</div>
            </div>
          </td>
        </tr>

        <tr rv-if="levels" class="levels-tr">
            <td>Levels:</td>
            <td><button rv-on-click='level.add'>Add level</button></td>
        </tr>
        <tr rv-if="levels">
            <td colspan="2">
                <table class="levels">
                    <thead> <tr>
                        <td rv-each-row="levels.fields">{row.title}</td>
                        <td></td>
                    </tr> </thead>
                    <tbody>
                      <tr rv-each-row="levels.values">
                        <td>{row.value}</td>
                        <td>{row.width}</td>
                        <td>
                          <div style="width:width:100%; height: 20px;" rv-css-background-color="row.color"/>
                        </td>
                        <td>
                          <div class="levels-dash-style"
                            rv-css-background-image="row.dashStyle | prepend 'url('images/dashstyle/' | append '.svg'"/>
                        </td>
                        <td>
                          <span rv-on-click='level.remove | bind row' class='ui-icon ui-icon-delete' rv-tooltip='"Remove"'></span>
                        </td>
                      </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>
    <div class='levels-dialog' rv-if='levels' rv-show='level.dialog.visible' rv-css-bottom="level.dialog.bottom">
      <table>
        <tr rv-each-row="levels.fields">
          <td>{row.title}</td>
          <td rv-if="row.type | eq 'slider'">
            <div rv-slider="row.value" rv-attr-min="row.min" rv-attr-max="row.max"></div>
          </td>
          <td rv-if="row.type | eq 'colorpicker'">
            <div rv-colorpicker="row.value"></div>
            <div class="colorpicker-preview" rv-css-background="row.value"></div>
          </td>
          <td rv-if="row.type | eq 'dashstyle'">
            <div class="dash-styles">
                <div
                  rv-each-dash="dash_styles"
                  rv-class-dash-selected="row.value | eq dash.name"
                  rv-attr-value="dash.name"
                  rv-on-click="update_dash | bind dash | bind row"
                  rv-css-background-image="dash.url"></div>
            </div>
          </td>
          <!-- <td rv-if="row.type | eq 'appliedto'">
            <div class="applied-to">
                <div rv-class-selected="row.value | eq 0" rv-on-click="update_appliedto | bind row | bind 0">OPEN</div>
                <div rv-class-selected="row.value | eq 1" rv-on-click="update_appliedto | bind row | bind 1">HIGH</div>
                <div rv-class-selected="row.value | eq 2" rv-on-click="update_appliedto | bind row | bind 2">LOW</div>
                <div rv-class-selected="row.value | eq 3" rv-on-click="update_appliedto | bind row | bind 3">CLOSE</div>
            </div>
          </td> -->
        </tr>
        <tr>
          <td></td>
          <td><button rv-on-click='level.dialog.cancel'>Cancel</button><button rv-on-click='level.dialog.add'>Add</button></td>
        </tr>
      </table>
    </div>
</div>
