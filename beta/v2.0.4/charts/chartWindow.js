define(["jquery","windows/windows","text!charts/chartWindow.html","jquery.dialogextend"],function(a,b,c){"use strict";function d(){a(this).find(".chartSubContainer").width(a(this).width()-20),a(this).find(".chartSubContainer").height(a(this).height()-10);var b="#"+a(this).find(".chartSubContainer").attr("id");require(["charts/charts"],function(a){a.triggerReflow(b)})}return{addNewWindow:function(e,f,g,h){var i={title:f+" ("+g+")",close:function(){var b=a(this).attr("id"),c=a("#"+b+"_chart"),d=c.data("timeperiod"),e=c.data("instrumentCode");a(this).dialog("destroy"),require(["charts/charts"],function(a){a.destroy("#"+b+"_chart",d,e)})},resize:d},j=b.createBlankWindow(c,i),k=j.attr("id");return j.find("div.chartSubContainerHeader").attr("id",k+"_header").end().find("div.chartSubContainer").attr("id",k+"_chart").end(),require(["charts/chartOptions"],function(a){a.init(k,g,h)}),require(["charts/charts"],function(a){a.drawChart("#"+k+"_chart",e,f,g,h,null,i.resize.bind(j))}),j.dialog("open"),j},totalWindows:function(){return a("div.webtrader-dialog").length},triggerResizeEffects:function(a){d.call(a)}}});