define(["jquery","windows/windows","jquery-growl"],function(a,b){function c(){null==f?a.get("token/token.html",function(c){c=a(c),f=b.createBlankWindow(c,{width:605,height:380,title:"Authentication Token",resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,close:function(){d&&d.reject({message:"User didn't provide a token"}),d=e=null},modal:!0});var g=c.find("input");c.find("button").first().button({icons:{primary:"ui-icon-check"}}).click(function(){var a=g.val();a?d.resolve(a):d.reject({message:"invalid token value"}),d=e=null,f.dialog("close")}).next().button({icons:{secondary:"ui-icon-cancel"}}).click(function(){d&&d.reject({message:"User didn't provide a token"}),d=e=null,f.dialog("close")}),f.dialog("open")}):f.dialog("open")}var d=(a("<div />"),null),e=null,f=null;return loadCSS("token/token.css"),{getTokenAsync:function(){return e?e:e=new Promise(function(a,b){d={resolve:a,reject:b},c()})}}});