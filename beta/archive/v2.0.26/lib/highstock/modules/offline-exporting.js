!function(a){"object"==typeof module&&module.exports?module.exports=a:a(Highcharts)}(function(a){function b(a,b){var c=e.getElementsByTagName("head")[0],d=e.createElement("script");d.type="text/javascript",d.src=a,d.onload=b,c.appendChild(d)}var c=a.win,d=c.navigator,e=c.document;a.CanVGRenderer={},a.Chart.prototype.exportChartLocal=function(f,g){var h,i,j,k,l,m=this,n=a.merge(m.options.exporting,f),o=d.userAgent.indexOf("WebKit")>-1&&d.userAgent.indexOf("Chrome")<0,p=n.scale||2,q=c.URL||c.webkitURL||c,r=0,s=function(){if(n.fallbackToExportServer===!1){if(!n.error)throw"Fallback to export server disabled";n.error()}else m.exportChart(n)},t=function(a,b,d,f,g,h,i){var j,k=new c.Image,l=function(){var c,f=e.createElement("canvas"),h=f.getContext&&f.getContext("2d");try{if(h){f.height=k.height*p,f.width=k.width*p,h.drawImage(k,0,0,f.width,f.height);try{c=f.toDataURL(),d(c,b)}catch(l){if("SecurityError"!==l.name&&"SECURITY_ERR"!==l.name&&"SecurityError"!==l.message)throw l;j(a,b)}}else g(a,b)}finally{i&&i(a,b)}},m=function(){h(a,b),i&&i(a,b)};j=function(){k=new c.Image,j=f,k.crossOrigin="Anonymous",k.onload=l,k.onerror=m,k.src=a},k.onload=l,k.onerror=m,k.src=a},u=function(a){try{if(!o&&d.userAgent.toLowerCase().indexOf("firefox")<0)return q.createObjectURL(new c.Blob([a],{type:"image/svg+xml;charset-utf-16"}))}catch(b){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(a)},v=function(a,b){var f,g=e.createElement("a"),h=(n.filename||"chart")+"."+b;if(d.msSaveOrOpenBlob)d.msSaveOrOpenBlob(a,h);else if(void 0!==g.download)g.href=a,g.download=h,g.target="_blank",e.body.appendChild(g),g.click(),e.body.removeChild(g);else try{if(f=c.open(a,"chart"),void 0===f||null===f)throw"Failed to open window"}catch(i){c.location.href=a}},w=function(){var f,g,i=m.sanitizeSVG(h.innerHTML);if(n&&"image/svg+xml"===n.type)try{d.msSaveOrOpenBlob?(g=new MSBlobBuilder,g.append(i),f=g.getBlob("image/svg+xml")):f=u(i),v(f,"svg")}catch(j){s()}else f=u(i),t(f,{},function(a){try{v(a,"png")}catch(b){s()}},function(){var f=e.createElement("canvas"),g=f.getContext("2d"),h=i.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*p,j=i.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*p,k=function(){g.drawSvg(i,0,0,h,j);try{v(d.msSaveOrOpenBlob?f.msToBlob():f.toDataURL("image/png"),"png")}catch(a){s()}};f.width=h,f.height=j,c.canvg?k():(m.showLoading(),b(a.getOptions().global.canvasToolsURL,function(){m.hideLoading(),k()}))},s,s,function(){try{q.revokeObjectURL(f)}catch(a){}})},x=function(a,b){++r,b.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",a),r===i.length&&w()};a.wrap(a.Chart.prototype,"getChartHTML",function(a){return h=this.container.cloneNode(!0),a.apply(this,Array.prototype.slice.call(arguments,1))}),m.getSVGForExport(n,g),i=h.getElementsByTagName("image");try{for(i.length||w(),k=0,l=i.length;l>k;++k)j=i[k],t(j.getAttributeNS("http://www.w3.org/1999/xlink","href"),{imageElement:j},x,s,s,s)}catch(y){s()}},a.getOptions().exporting.buttons.contextButton.menuItems=[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}}]});