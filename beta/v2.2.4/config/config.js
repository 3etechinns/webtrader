define(["exports","jquery","../windows/windows","../common/rivetsExtra","../websockets/binary_websockets","lodash","text!./config.html","../common/util","css!./config.css"],function(a,b,c,d,e,f,g){"use strict";function h(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.init=void 0;var i=h(b),j=h(c),k=h(d),l=h(e),m=h(f),n=h(g),o=null,p=null,q=function(){var a=i["default"](n["default"]).i18n(),b=r(a);p=k["default"].bind(a[0],b),o=j["default"].createBlankWindow(a,{title:"Change Backend Server".i18n(),resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,modal:!0,ignoreTileAction:!0,open:function(){var a=local_storage.get("config");b.app_id=l["default"].app_id,b.websocket_url=l["default"].socket_url,a&&a.oauth_url&&(b.oauth_url=m["default"].replace(m["default"].replace(a.oauth_url||"","https://",""),"/oauth2/authorize",""))},close:function(){p&&p.unbind(),o&&o.dialog("destroy").remove(),p=o=null},buttons:[{text:"Apply".i18n(),icons:{primary:"ui-icon-check"},click:b.apply},{text:"Reset to Defaults".i18n(),icons:{primary:"ui-icon-refresh"},click:b.reset}]}),o.dialog("open")},r=function(){var a={websocket_url:l["default"].socket_url,oauth_url:"oauth.binary.com",app_id:l["default"].app_id};return a.apply=function(){var b=(local_storage.get("i18n")||{value:"en"}).value,c={websocket_url:"wss://"+a.websocket_url+"/websockets/v3?l="+b,oauth_url:"https://"+a.oauth_url+"/oauth2/authorize",app_id:a.app_id};local_storage.set("config",c),a.reload_page()},a.reset=function(){local_storage.remove("config"),a.reload_page()},a.reload_page=function(){i["default"].growl.notice({message:"Config changes successful.<br/>Reloading page ...".i18n()}),setTimeout(function(){window.location.reload()},900)},a},s=a.init=function(a){a.click(function(){o?o.moveToTop():q()})};a["default"]={init:s}});