define(["jquery","charts/chartWindow","common/util"],function(a){return{init:function(b,c,d,e,f){require(["text!charts/chartOptions.html","css!charts/chartOptions.css"],function(g){g=a(g),g.find(".chartMenuHamburgerMenu").hover(function(){a(this).toggleClass("ui-state-hover").toggleClass("ui-state-active")}).click(function(){return a(this).toggleClass("active").next("ul:first").toggle(),!1}).focusout(function(){a(this).removeClass("active").next("ul:first").menu().hide()}),g.find("ul:first").menu(),isTick(c)&&g.find(".candlestick, .ohlc").addClass("ui-state-disabled"),e||g.find(".chartType li.table").hide(),g.find(".chartType li."+d).find("span:first").addClass("ui-icon ui-icon-check"),g.find(".chartType li").click(function(){if(!a(this).hasClass("ui-state-disabled")){var c=a(this).attr("class").split(" ")[0].replace(".","").trim();"table"===c?e():(g.find(".chartType li span").removeClass("ui-icon ui-icon-check"),a(this).find("span:first").addClass("ui-icon ui-icon-check"),a("#"+b+"_chart").data("type",c),require(["charts/charts"],function(a){a.refresh("#"+b+"_chart")})),a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu").click();var d=a("#"+b+"_chart");d.trigger("chart-type-changed",c)}}),g.find("ul:first > li").each(function(){a(this).click(function(){if(!a(this).hasClass("ui-state-disabled"))if(a(this).hasClass("logScaleLI")){var c=a("#"+b+"_chart").highcharts().series[0],d=a(this).find("span:first").hasClass("ui-icon-check");c.yAxis.update({type:d?"linear":"logarithmic"}),a(this).find("span:first").toggleClass("ui-icon ui-icon-check");var e=a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu");e.hasClass("active")&&e.click()}else if(a(this).hasClass("crosshairLI"))require(["charts/crosshair"],function(a){a.toggleCrossHair("#"+b+"_chart")}),a(this).find("span:first").toggleClass("ui-icon ui-icon-check"),a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu").click();else if(a(this).hasClass("refresh"))require(["charts/charts"],function(a){a.refresh("#"+b+"_chart")}),a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu").click();else if(a(this).hasClass("currentPriceLI")){var f=a(this);require(["currentPriceIndicator"],function(){var c="#"+b+"_chart",d=a(c).highcharts(),e=!f.find("span:first").hasClass("ui-icon-check");e?a.each(d.series,function(a,b){b.options.isInstrument&&b.removeCurrentPrice()}):d.series.forEach(function(a){a.options.isInstrument&&a.addCurrentPrice()})}),a(this).find("span:first").toggleClass("ui-icon ui-icon-check"),a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu").click()}})}),g.find("li.indicators-add-remove").click(function(){require(["charts/indicators/indicatorManagement"],function(a){var d=f+" ("+c+")";a.openDialog("#"+b+"_chart",d)})}),g.find("li.overlay-add-remove").click(function(){require(["charts/overlay/overlayManagement"],function(a){var d=f+" ("+c+")";a.openDialog("#"+b+"_chart",d)})}),g.find(".drawLI li").click(function(){a(this).hasClass("addChartObject")?require(["charts/draw/chartobject_add"],function(a){a.openDialog("#"+b+"_chart")}):a(this).hasClass("removeChartObject")&&(require(["charts/draw/chartobject_remove"],function(a){a.showDialog("#"+b+"_chart")}),a(this).closest(".chartOptions").find(".chartMenuHamburgerMenu").click())}),a("#"+b+"_header").prepend(g)})},disableEnableLogMenu:function(b,c){var d=a("#"+b+"_header").find("li.logScaleLI");c?d.removeClass("ui-state-disabled"):d.addClass("ui-state-disabled")},triggerToggleLogScale:function(b){a("#"+b+"_header").find("li.logScaleLI").click()},isCurrentViewInLogScale:function(b){var c=a("#"+b+"_header").find("li.logScaleLI");return c.find("span:first").hasClass("ui-icon-check")&&!c.hasClass("ui-state-disabled")},disableEnableCandlestick:function(b,c){var d=a("#"+b+"_header").find("li.candlestick");c?d.removeClass("ui-state-disabled"):d.addClass("ui-state-disabled")},disableEnableOHLC:function(b,c){var d=a("#"+b+"_header").find("li.ohlc");c?d.removeClass("ui-state-disabled"):d.addClass("ui-state-disabled")},selectChartType:function(b,c,d){d?a("#"+b+"_header").find(".chartType li."+c).click():(a("#"+b+"_header").find(".chartType li span").removeClass("ui-icon ui-icon-check"),a("#"+b+"_header").find(".chartType li."+c).find("span:first").addClass("ui-icon ui-icon-check"))}}});