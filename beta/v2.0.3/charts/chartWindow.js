define(["jquery","windows/windows","jquery.dialogextend"],function(a,b){"use strict";function c(){a(this).find(".chartSubContainer").width(a(this).width()-20),a(this).find(".chartSubContainer").height(a(this).height()-10);var b="#"+a(this).find(".chartSubContainer").attr("id");require(["charts/charts"],function(a){a.triggerReflow(b)})}return{addNewWindow:function(d,e,f,g,h){require(["text!charts/chartWindow.html"],function(i){var j={title:e+" ("+f+")",close:function(){var b=a(this).attr("id"),c=a("#"+b+"_chart"),d=c.data("timeperiod"),e=c.data("instrumentCode");a(this).dialog("destroy"),require(["charts/charts"],function(a){a.destroy("#"+b+"_chart",d,e)})},resize:c},k=b.createBlankWindow(i,j),l=k.attr("id");k.find("div.chartSubContainerHeader").attr("id",l+"_header").end().find("div.chartSubContainer").attr("id",l+"_chart").end(),require(["charts/chartOptions"],function(a){a.init(l,f,h)}),require(["charts/charts"],function(a){a.drawChart("#"+l+"_chart",d,e,f,h,null,j.resize.bind(k))}),k.dialog("open"),g&&g(k)})},totalWindows:function(){return a("div.chart-dialog").length},triggerResizeEffects:function(a){c.call(a)}}});