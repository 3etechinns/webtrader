define(["jquery","jquery.dialogextend"],function(a){"use strict";function b(){a(this).find(".chartSubContainer").width(a(this).width()-30),a(this).find(".chartSubContainer").height(a(this).height()-10);var b="#"+a(this).find(".chartSubContainer").attr("id");require(["charts/charts"],function(a){a.triggerReflow(b)})}var c=0,d={onCreate:a.Callbacks(),onRemove:a.Callbacks()};return{addNewWindow:function(e,f,g,h,i){var j="chart-dialog-"+ ++c;a.get("charts/chartWindow.html",function(c){var k=f+" ("+g+")";c=a(c);var l=c.attr("id",j).dialog({autoOpen:!1,resizable:!0,minWidth:350,minHeight:400,width:350,height:400,my:"center",at:"center",of:window,title:k,close:function(){var b="#"+j+"_chart",c=a(b).data("timeperiod"),d=a(b).data("instrumentCode");a(this).dialog("destroy"),require(["charts/charts"],function(a){a.destroy("#"+j+"_chart",c,d)})},resize:b}).dialogExtend({maximize:b,restore:b,minimize:b,resize:b}).find("div.chartSubContainerHeader").attr("id",j+"_header").end().find("div.chartSubContainer").attr("id",j+"_chart").end();l.on("dialogclose",d.onRemove.fire.bind(null,k,l)),d.onCreate.fire(k,l),require(["charts/chartOptions"],function(a){a.init(j,g,i)}),a("#"+j).dialog("open"),b.call(a("#"+j)),require(["charts/charts"],function(a){a.drawChart("#"+j+"_chart",e,f,g,i)}),h&&h(a("#"+j))})},totalWindows:function(){return a("div.chart-dialog").length},triggerResizeEffects:function(a){b.call(a)},events:d}});