{"version":3,"sources":["../../../../src/workspace/workspace.es6"],"names":["INITIAL_WORKSPACE_NAME","states","local_storage","get","name","set","clone","JSON","parse","stringify","obj","state","route","workspaces","dialogs","update_route","tileDialogs","closeAll","dialog","workspace","remove","inx","indexOf","w","splice","show","current_workspace","reopen","name_perv_value","save","_","findIndex","saveas","growl","notice","message","i18n","rename","apply","cancel","find","matches","match","number","parseInt","replace","push","init","parent","root","append","bind","addDialog","clickCb","removeCb","row","click","cleaner","events","shuffle","array","temp","rand_inx","length","Math","floor","random","filter","d","$d","hasClass","window","width","arrange","perform","total_free_space","max_x","y","is","inx_start","row_height","x","h","max","free_space","margin_left","j","animate","left","top","trigger","my","at","best","best_free_space","i","slice","largeDialogs","forEach","setTimeout"],"mappings":"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","file":"workspace.js","sourcesContent":["import html from 'text!./workspace.html';\nimport rv from '../common/rivetsExtra';\nimport $ from 'jquery';\nimport 'jquery-growl';\nimport 'css!./workspace.css';\nimport tracker from '../windows/tracker';\n\nconst INITIAL_WORKSPACE_NAME = 'my-workspace-1';\n(() => {\n   const states = local_storage.get('states');\n   if(states && !states.name) {\n      states.name = INITIAL_WORKSPACE_NAME;\n      local_storage.set('states', states);\n   }\n})();\n\nconst clone = obj => JSON.parse(JSON.stringify(obj));\n\nconst state = {\n   route: 'all', // one of ['all', 'active', 'saved', 'rename']\n   workspaces: local_storage.get('workspaces') || [],\n   dialogs: [ ],\n   update_route: route => state.route = route,\n   tileDialogs: () => tileDialogs(),\n   closeAll: () => $('.webtrader-dialog').dialog('close'),\n   workspace: {\n      remove: w => {\n         const inx = state.workspaces.indexOf(w);\n         inx !== -1 && state.workspaces.splice(inx, 1);\n         local_storage.set('workspaces', state.workspaces);\n      },\n      show: w => {\n         state.closeAll();\n         state.current_workspace.name = w.name;\n         local_storage.set('states', w);\n         tracker.reopen(clone(w));\n      }\n   },\n   current_workspace: {\n      name: (local_storage.get('states') || {  }).name || 'my-workspace-1',\n      name_perv_value: '',\n      save: () => {\n         const {name} = state.current_workspace;\n         const inx = _.findIndex(state.workspaces, {name: name});\n         if(inx === -1) {\n            return state.saveas.show();\n         }\n         const workspace = local_storage.get('states');\n         workspace.name = name;\n         state.workspaces[inx] = workspace;\n         local_storage.set('workspaces', state.workspaces);\n         $.growl.notice({ message: 'Workspace changes saved'.i18n() });\n      }\n   },\n   rename: {\n      show: () => {\n         state.current_workspace.name_perv_value = state.current_workspace.name;\n         state.route = 'rename';\n      },\n      apply: () => { \n         let {name, name_perv_value} = state.current_workspace;\n         if(!name || name === name_perv_value) { \n            return state.rename.cancel();\n         }\n         if(_.find(state.workspaces, {name: name})) {\n            const matches = name.match(/\\d+$/);\n            const number = matches ? parseInt(matches[0]) : 0;\n            name = name.replace(/\\d+$/, '') + (number + 1);\n         }\n         const workspace = _.find(state.workspaces, {name: name_perv_value});\n         if(workspace) {\n            workspace.name = name;\n            state.workspaces = state.workspaces;\n            local_storage.set('workspaces', state.workspaces);\n         }\n         state.current_workspace.name = name;\n         state.route = 'active';\n      },\n      cancel: () => {\n         state.current_workspace.name = state.current_workspace.name_perv_value;\n         state.route = 'active';\n      }\n   },\n   saveas: {\n      show: () => {\n         state.current_workspace.name_perv_value = state.current_workspace.name;\n         state.route = 'saveas';\n      },\n      apply: () => { \n         let {name, name_perv_value} = state.current_workspace;\n         if(!name) { \n            return state.saveas.cancel();\n         }\n         if(_.find(state.workspaces, {name: name})) {\n            const matches = name.match(/\\d+$/);\n            const number = matches ? parseInt(matches[0]) : 0;\n            name = name.replace(/\\d+$/, '') + (number + 1);\n         }\n         const workspace = local_storage.get('states');\n         workspace.name = name;\n         state.workspaces.push(workspace);\n         local_storage.set('workspaces', state.workspaces);\n\n         state.current_workspace.name = name;\n         state.route = 'active';\n      },\n      cancel: () => state.rename.cancel()\n   }\n};\n\nexport const init = (parent) => {\n   const root = $(html);\n   parent.append(root);\n   rv.bind(root[0], state);\n}\nexport const addDialog = (name, clickCb, removeCb) => {\n   const row = {\n      name: name,\n      click: () => clickCb(),\n      remove: () => { cleaner(); removeCb(); } \n   };\n   const cleaner = () => {\n      const inx = state.dialogs.indexOf(row);\n      inx !== -1 && state.dialogs.splice(inx, 1);\n   }\n   state.dialogs.push(row);\n   return cleaner;\n}\n\nexport const events = $('<div/>');\n\nexport const tileDialogs = () => {\n   /* shuffle the given array */\n   const shuffle = (array) => {\n      let temp, rand_inx;\n\n      for (let inx = array.length; inx > 0;) {\n         rand_inx = Math.floor(Math.random() * inx);\n         --inx;\n         temp = array[inx];\n         array[inx] = array[rand_inx];\n         array[rand_inx] = temp;\n      }\n\n      return array;\n   }\n\n   // get array of dialogs\n   var dialogs = $('.webtrader-dialog').filter((inx, d) => {\n      /* check to see if initialized and is visible */\n      const $d = $(d);\n      return $d.hasClass(\"ui-dialog-content\") && $d.dialog(\"isOpen\") &&\n            !$d.hasClass('ui-dialog-minimized') && ($(window).width() >= $d.dialog('option', 'width'));\n   });\n\n\n   const arrange = (dialogs, perform) => {\n      let total_free_space = 0;\n\n      const max_x = $(window).width();\n      let y = 115; // position of the next window from top\n      if($(\"#msg-notification\").is(\":visible\"))\n            y = 150;\n\n      for (var inx = 0; inx < dialogs.length;) {\n         var inx_start = inx;\n         var row_height = 0; // height of the current row of dialogs\n         var x = 0; // positon of the next window from left\n\n         for (;/* see which which dialogs fit into current row */;) {\n            if (inx == dialogs.length)\n               break;\n            const d = $(dialogs[inx]);\n            const w = d.dialog('option', 'width'),\n               h = d.dialog('option', 'height');\n            row_height = Math.max(row_height, h);\n            if (x + w <= max_x) {\n               x += w;\n               ++inx;\n            }\n            else\n               break;\n         }\n\n         /* divide the vertical space equally between dialogs. */\n         const free_space = x < max_x ? (max_x - x) : 0;\n         let margin_left = x < max_x ? (max_x - x) / (inx - inx_start + 1) : 0; /* the current window might be wider than screen width */\n         if(inx != dialogs.length) { /* we don't care about extra space at last row */\n            total_free_space += free_space;\n         }\n         if (x === 0 && $(dialogs[inx]).dialog('option', 'width') > max_x) {\n            ++inx;\n            margin_left = 0;\n         };\n         x = 0;\n         for (var j = inx_start; j < inx; ++j) {\n            x += margin_left;\n            const d = $(dialogs[j]);\n            const w = d.dialog('option', 'width'),\n               h = d.dialog('option', 'height');\n\n            if(perform) /* are we testing or do we want to arrange elements */\n               d.dialog('widget').animate({\n                  left: x + 'px',\n                  top: y + 'px'\n               }, 1500, d.trigger.bind(d, 'animated'));\n            /* update dialog option.position */\n            d.dialog(\"option\", \"position\", { my: x, at: y });\n            x += w;\n         };\n         y += row_height + 20;\n      }\n      return total_free_space;\n   }\n\n   /* we will try 100 different arrangements and pick the best one */\n   let best = null,\n      best_free_space = 1000*1000;\n   for (var i = 0; i < 100; ++i) {\n      shuffle(dialogs); // shuffle dialogs\n      var total_free_space = arrange(dialogs, false);\n      if (total_free_space < best_free_space) {\n         best = dialogs.slice(); // clone the array\n         best_free_space = total_free_space;\n      }\n   }\n   // get array of large dialogs (larger than window size)\n   const largeDialogs = $('.webtrader-dialog').filter(function (inx, d) {\n      /* check to see if initialized and is visible */\n      const $d = $(d);\n      return $d.hasClass(\"ui-dialog-content\") && $d.dialog(\"isOpen\") && !$d.hasClass('ui-dialog-minimized') && ($(window).width() < $d.dialog('option', 'width'));\n   });\n   _(largeDialogs).forEach(function (d) {\n      best.push(d);\n   });\n   arrange(best, true);\n\n   setTimeout(() => events.trigger('tile'), 1600);\n}\n\nexport default { init, addDialog, events, tileDialogs };\n"]}